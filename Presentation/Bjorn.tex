%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% NAME %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%
%\section{Introduction}
%
%\begin{frame}{Introduction}{Overview}
%  \begin{figure}[H]
%	\centering
%	%\includegraphics[scale=0.65]{Pictures/Cubli12.png}
%  \end{figure}
%\end{frame}

% ---------------------------------------------------
\section{System Description}

\begin{frame}{System Description}{Overview}

\begin{textblock*}{15cm}(2.5cm,2.5cm)
	  	%\centering
	  	\includegraphics[scale=0.235]{Pictures/sysDescribtionTotal.pdf}
\end{textblock*}
	  
%  \begin{minipage}{\linewidth}
%  	\begin{minipage}{0.45\linewidth}
%  		\begin{figure}[H]
%  			\includegraphics[scale=0.5]{Pictures/Cubli-3.png}
%  			\centering
%  		\end{figure}
%  	\end{minipage}
%  	\hspace{0.03\linewidth}
%  	\begin{minipage}{0.45\linewidth}
%  		\begin{figure}[H]
%  			\includegraphics[scale=0.5]{Pictures/Cubli-1.png}
%  			\centering
%  		\end{figure}
%  	\end{minipage}
%  \end{minipage}
%  
%  \begin{textblock*}{8cm}(4cm,2cm)
%  	%\centering
%  	\includegraphics[scale=0.30]{Pictures/EC45FL.jpg}
%  \end{textblock*}
%  
%\begin{textblock*}{8cm}(4cm,7cm)
%	%\centering
%	\includegraphics[scale=0.08]{Pictures/esconMotorControl.png}
%\end{textblock*}
%
%\begin{textblock*}{8cm}(8cm,7.5cm)
%	%\centering
%	\includegraphics[scale=0.40]{Pictures/beagleBoneBlack.jpg}
%\end{textblock*}

\end{frame}

%\begin{frame}{System Description}{Overview}
%	\begin{figure}[H]
%		\centering
%		\includegraphics[scale=0.16]{Pictures/Cubli12.png}
%	\end{figure}
%\end{frame}

% -------------------------------------------------------
\section{Requirements}

\begin{frame}{Requirements}{Design Considerations}
	
	\begin{figure}[H]
		\includegraphics[scale=0.4]{Pictures/reqCubli0rad.png}
		\centering
	\end{figure}
	
\begin{itemize}
 \item {Balancing at \si{\theta_F} =  0 rad}
 \linebreak
%  \begin{itemize}
%	%\item {Starting out from equilibrium position at null velocity}
%	\item {Starting with the wheel at \si{0\ rad/s}}
%	\linebreak
%	\end{itemize}
\item {Still balance with changing angles of the baseplate}
\end{itemize}


\end{frame}

% -----------------------------------------------------------------
\section{Model}
\subsection{Overview}
\begin{frame}{Model}{Overview}
	\begin{figure}[H]
		\centering
		\includegraphics[scale=0.5]{Pictures/mechanicalSystem.pdf}
	\end{figure}
\end{frame}

\subsection{Free-Body Diagram}
\begin{frame}{Model}{Free-Body Diagram of the Wheel}
	\begin{textblock*}{15cm}(5cm,2cm)
		%\centering
		\includegraphics[scale=0.40]{Pictures/freeBodyWheel.pdf}
	\end{textblock*}
	
	\begin{textblock*}{15cm}(0cm,8cm)
	\begin{displaymath}	
	  \si{ J_w (\vec{\ddot{\theta}_F} + \vec{\ddot{\theta}_w}) =} 
	  \si{ \vec{\tau_m} - B_w \vec{\dot{\theta}_w }}
	\end{displaymath}
	\end{textblock*}
\end{frame}

\begin{frame}{Model}{Free-Body Diagram of the Frame}

%	\begin{textblock*}{5cm}(3cm,1cm) % {block width} (coords)
%		\includegraphics[width=5cm]{images/logo.jpg}
%	\end{textblock*}
	\only<1-2>{
	\begin{textblock*}{15cm}(5cm,2cm)
		%\centering
		\includegraphics[scale=0.40]{Pictures/freeBodyFrame.pdf}%
	\end{textblock*}
	}
	\only<1>{
	\begin{textblock*}{15cm}(0cm,8cm)
	\begin{displaymath}
	\si{J_F \vec{\ddot{\theta}_F} =}
	\si{-B_F \vec{\dot{\theta}_F} + \vec{l_F} \times (m_F\cdot \vec{g}) + \vec{l_w} \times \vec{F} - \vec{\tau_m} + B_w \vec{\dot{\theta}_w}}
	\end{displaymath}
	\end{textblock*}
	
}
	\only<2>{
		\begin{textblock*}{15cm}(0cm,8cm)
		\begin{displaymath}
		\si{ \vec{l_w} \times \vec{F} = (-{l_w}^2 \cdot m_w \ddot{\theta}_F + l_w\ sin(\theta_F)\ m_w \cdot g ) \cdot \hat{k}} %\nonumber
		\end{displaymath}
		\end{textblock*}
	}

\end{frame}

%\begin{frame}{Model}{Construction}
%	
%		\begin{flalign}
%		\si{\vec{l_w} \times \vec{F}}	\nonumber
%		\end{flalign}
%		
%		\begin{flalign}
%		\si{\vec{l_w} \times \vec{F}} &=
%		\begin{vmatrix}
%		\ \si{\vec{\hat{i}}} \nonumber               & \si{\vec{\hat{j}}} \nonumber              & \si{\vec{\hat{k}}}\nonumber \ \ \ \\ 
%		\ \si{ l_w \cdot cos( \theta_F ) }\nonumber  & \si{ l_w \cdot sin( \theta_F ) }\nonumber & 0 \nonumber                 \ \ \ \\ 
%		\ \si{ F_x }      \nonumber                  & \si{ F_y }      \nonumber                & 0      \nonumber            \ \ \  
%		\end{vmatrix}\nonumber
%		\end{flalign}
%	
%%		\begin{flalign}
%%		\si{ \vec{l_w} \times \vec{F} = (-{l_w}^2 \cdot m_w \ddot{\theta}_F + l_w\ sin(\theta_F)\ m_w \cdot g ) \cdot \hat{k}} \nonumber
%%		\end{flalign}
%%	
%	
%\end{frame}

\subsection{Frame Angle and Wheel velocity}
\begin{frame}{Model}{Frame and Wheel Equations}
	\begin{itemize}
		\item Acceleration of the frame
	\end{itemize}
\small
	\begin{flalign}
%	 \si{\ddot{\theta}_F =} &\si{ -\frac{B_F}{J_F + m_w \cdot {l_w}^2} \cdot \dot{\theta}_F + \frac{(m_F \cdot l_F + m_w \cdot l_w) \cdot g}{J_F + m_w \cdot {l_w}^2} \cdot sin(\theta_F) }& \nonumber \\ 
%		&\si{- \frac{1}{J_F + m_w \cdot {l_w}^2} \cdot \tau_m + \frac{B_w}{J_F + m_w \cdot {l_w}^2} \cdot \dot{\theta}_w} & \nonumber
\si{\ddot{\theta}_F = \frac{- B_F \cdot \dot{\theta}_F + (m_F \cdot l_F + m_w \cdot l_w) \cdot g \cdot sin(\theta_F) - \tau_m + B_w \cdot \dot{\theta}_w}{J_F + m_w \cdot {l_w}^{2}}} \nonumber
	\end{flalign}
	\vspace{0.5cm}
\normalsize	
%
\begin{itemize}
	\item Acceleration of the wheel
\end{itemize}
\small
	\begin{flalign}
%	\si{\ddot{\theta}_w =} &\si{\frac{J_w+J_F+m_w \cdot {l_w}^{2}}{J_w \cdot (J_F+m_w \cdot {l_w}^{2})} \cdot \tau_m - \frac{(J_w+J_F+{l_w}^{2} \cdot m_w) \cdot B_w}{J_w \cdot (J_F+m_w \cdot  {l_w}^2)} \cdot \dot{\theta}_w}& \nonumber \\
%	&\si{ - \frac{(m_F \cdot l_F + m_w \cdot l_w) \cdot g}{J_F+m_w \cdot {l_w}^{2}} \cdot sin(\theta_F) + \frac{B_F}{J_F+m_w \cdot {l_w}^{2}} \cdot \dot{\theta}_F} & \nonumber
\si{\ddot{\theta}_w = \frac{\tau_m - B_w \cdot \dot{\theta}_w}{J_w} - \ddot{\theta}_F} \nonumber
	\end{flalign}
\normalsize
	
\end{frame}

\subsection{Linearization}
\begin{frame}{Model}{Linearization}
%	\begin{flalign}
%	\si{\ddot{\theta}_F =} &\si{ -\frac{B_F}{J_F + m_w \cdot {l_w}^2} \cdot \dot{\theta}_F + \frac{(m_F \cdot l_F + m_w \cdot l_w) \cdot g}{J_F + m_w \cdot {l_w}^2} \cdot sin(\theta_F) }& \nonumber \\ 
%	&\si{- \frac{1}{J_F + m_w \cdot {l_w}^2} \cdot \tau_m + \frac{B_w}{J_F + m_w \cdot {l_w}^2} \cdot \dot{\theta}_w} & \nonumber
%	\end{flalign}
\small
\begin{flalign}
\si{(J_F+m_w \cdot {l_w}^{2})\cdot (\ddot{\theta}_{F})} &= \si{- B_F \cdot (\dot{\theta}_{F})}   \nonumber\\
&\ \ \ \ \si{+ (m_F \cdot l_F + m_w \cdot l_w) \cdot g \cdot sin(\theta_{F})} \nonumber\\
&\ \ \ \ \si{- (\tau_{m}) + B_w \cdot (\dot{\theta}_{w})} \nonumber
%	\si{(J_F+m_w \cdot {l_w}^{2}) (\ddot{\theta}_{F_0} + \Delta \ddot{\theta}_F )= f( (\dot{\theta}_{F_0} + \Delta \dot{\theta}_F), \ (\theta_{F_0} + \Delta \theta_F), \ (\tau_{m_0} + \Delta \tau_m),\  (\dot{\theta}_{w_0} + \Delta \dot{\theta}_w) ) } \nonumber
\end{flalign}
\normalsize

\pause
	\begin{itemize}
		\item {Operating point} 
		\begin{itemize}
			\item {\si{\theta_{F_0}\ =\ 0\ rad}}
			\item {\si{\dot{\theta}_{w_0}\ =\ 0\ rad \cdot s^{-1}}}
			\item {variation around operating point is \si{\Delta \theta_F}}
		\end{itemize}
	\end{itemize}
	
	\pause
	\small
	\begin{flalign}
	\si{(J_F+m_w \cdot {l_w}^{2})\cdot(\ddot{\theta}_{F_0} + \Delta \ddot{\theta}_F )} &= \si{- B_F \cdot (\dot{\theta}_{F_0} + \Delta \dot{\theta}_F) }   \nonumber\\
	&\ \ \ \ \si{+ (m_F \cdot l_F + m_w \cdot l_w) \cdot g \cdot sin(\theta_{F_0} + \Delta \theta_F)} \nonumber\\
	&\ \ \ \ \si{- (\tau_{m_0} + \Delta \tau_m) + B_w \cdot (\dot{\theta}_{w_0} +\Delta \dot{\theta}_w)} \nonumber
%	\si{(J_F+m_w \cdot {l_w}^{2}) (\ddot{\theta}_{F_0} + \Delta \ddot{\theta}_F )= f( (\dot{\theta}_{F_0} + \Delta \dot{\theta}_F), \ (\theta_{F_0} + \Delta \theta_F), \ (\tau_{m_0} + \Delta \tau_m),\  (\dot{\theta}_{w_0} + \Delta \dot{\theta}_w) ) } \nonumber
	\end{flalign}
	\normalsize
	
\end{frame}

\begin{frame}{Model}{Linearization}
		\small
		\begin{flalign}
		\si{(J_F+m_w \cdot {l_w}^{2}) \Delta \ddot{\theta}_F } &= \cancelto{0}{\si{f( \dot{\theta}_{F_0}, \ \theta_{F_0}, \ \tau_{m_0},\ \dot{\theta}_{w_0} )}}   \nonumber\\
		&\ \ \ \ \si{+ \frac{\partial}{\partial \dot{\theta}_F} f\cdot \Delta \dot{\theta}_F + \frac{\partial}{\partial \theta_F} f\cdot \Delta \theta_F + \frac{\partial}{\partial \tau_m} f\cdot \Delta \tau_m + \frac{\partial}{\partial \dot{\theta}_w} f\cdot \Delta \dot{\theta}_w} \nonumber
		\end{flalign}
		\normalsize
		\begin{itemize}
			\item {Linearized expression for frame acceleration}
		\end{itemize}
\small
		\begin{flalign}
%		&\si{(J_F+m_w \cdot {l_w}^{2}) \Delta \ddot{\theta}_F =} \nonumber \\
%		&\si{-B_F \Delta \dot{\theta}_F +  ( m_F \cdot l_F + m_w \cdot l_w ) \cdot g \cdot \Delta \theta_F - \Delta \tau_m + B_w \Delta \dot{\theta}_w } \nonumber
		\si{(J_F+m_w \cdot {l_w}^{2}) \Delta \ddot{\theta}_F = -B_F \Delta \dot{\theta}_F +  ( m_F \cdot l_F + m_w \cdot l_w ) \cdot g \cdot \Delta \theta_F - \Delta \tau_m + B_w \Delta \dot{\theta}_w } \nonumber
		\end{flalign}
		\normalsize
\end{frame}

\subsection{Block Diagram}
\begin{frame}{Model}{Block Diagram}
	
		\begin{itemize}
			\item {Laplace Transformation}
			\begin{itemize}
				\item {Replace \si{\theta_w}}
			\end{itemize}
		\end{itemize}
		\small
		\begin{flalign}
		&\si{\theta_w\cdot s^2 = \frac{\tau_m - B_w \theta_w\cdot s}{J_w} - \theta_F\cdot s^2} \nonumber \\\nonumber\\
		%\si{{\theta}_w \cdot s^2 = \frac{\tau_m - B_w \cdot {\theta}_w\cdot s }{J_w} - {\theta}_F \cdot s^2} \nonumber
		&\si{(J_F+m_w \cdot {l_w}^{2}) \cdot \theta_F \cdot s^2 = -B_F \theta_F\cdot s +  ( m_F \cdot l_F + m_w \cdot l_w ) g \cdot \theta_F - \tau_m + B_w \theta_w\cdot s } \nonumber
		\end{flalign}
		\normalsize
	
	\begin{figure}[H]
		\centering
		\input{Pictures/blockDiagram.tikz}
	\end{figure}
\end{frame}
%\section{Hardware and Software}
%%%%%%%%%%%%%%%%%
%\subsection{Prototype overview}
%
%\begin{frame}{Hardware and Software}{Prototype overview}
%  \begin{figure}[H]
%	\centering
%	\includegraphics[scale=0.65]{Pictures/SO3.pdf}
%  \end{figure}
%\end{frame}
%%%%%%%%%%%%%%%%%
%
%%%%%%%%%%%%%%%%%
%\subsection{Hardware components}
%
%\begin{frame}{Hardware and Software}{Hardware components}
%\textbf{Controller}
%\begin{itemize}
%\item{Arduino Mega 2560}
%\end{itemize}
%  \begin{figure}[H]
%	\centering
%	\includegraphics[scale=0.4]{Pictures/ArduinoMega.png}
%  \end{figure}
%\end{frame}
%
%\begin{frame}{Hardware and Software}{Hardware components}
%\textbf{Velocity Sensor}
%\begin{itemize}
%\item{Hall Sensor}
%\end{itemize}
%  \begin{figure}[H]
%	\centering
%	\includegraphics[scale=1.5]{Pictures/hallSensorDrawing.pdf}
%  \end{figure}
%\end{frame}
%
%\begin{frame}{Hardware and Software}{Hardware components}
%\textbf{Angular Sensor}
%\begin{itemize}
%\item{HMC5883L Magnetometer}
%\end{itemize}
%
%  \begin{minipage}{\linewidth}
%  	\begin{minipage}{0.45\linewidth}
%  		\begin{figure}[H]
%  			\includegraphics[scale=0.7]{Pictures/NineDegree.jpg}
%  			\centering
%  		\end{figure}
%  	\end{minipage}
%  	\hspace{0.03\linewidth}
%  	\begin{minipage}{0.45\linewidth}
%  		\begin{figure}[H]
%  			\includegraphics[scale=0.35]{Pictures/Magne.pdf}
%  			\centering
%  		\end{figure}
%  	\end{minipage}
%  \end{minipage}
%
%\end{frame}
%
%
%
%
%\begin{frame}{Hardware and Software}{Hardware components}
%\textbf{Position Sensor}
%\begin{itemize}
%\item{Games on Track system (GoT)}
%\end{itemize}
%  \begin{figure}[H]
%	\centering
%	\includegraphics[scale=0.6]{Pictures/GOTNew.pdf}
%  \end{figure}
%\end{frame}
%
%\begin{frame}{Hardware and Software}{Hardware components}
%\begin{itemize}
%\item {Communication}
%\item {Storage}
%\item {Motor driver}
%\item {Battery and Power monitor}
%\end{itemize}
%\end{frame}
%%%%%%%%%%%%%%%%%
%
%%%%%%%%%%%%%%%%%
%\subsection{Software}
%
%\begin{frame}{Hardware and Software}{Software}
%\begin{itemize}
% \item {Real Time Operating System}
%  \begin{itemize}
%	\item {KRNL by Jens Dalsgaard Nielsen}
%\end{itemize}
%\end{itemize}
%
%  \begin{figure}[H]
%	\centering
%	\includegraphics[scale=0.35]{Pictures/scheduleRequest.pdf}
%  \end{figure}
%
%  \begin{figure}[H]
%	\centering
%	\includegraphics[scale=0.3]{Pictures/schedulePriorities.pdf}
%  \end{figure}
%\end{frame}